
"use client";

import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { useToast } from '@/hooks/use-toast';
import { db } from '@/lib/firebase';
import { collection, addDoc, getDocs } from 'firebase/firestore';
import { HardDriveUpload, CheckCircle, AlertTriangle } from 'lucide-react';
import Link from 'next/link';

const oldBlogData = [
    {
        slug: "วิธีซักโซฟาผ้าด้วยตัวเองเบื้องต้น",
        image: "https://placehold.co/800x400.png",
        imageHint: "woman cleaning sofa",
        date: "2024-07-21",
        title: "วิธีซักโซฟาผ้าด้วยตัวเองเบื้องต้น กำจัดคราบง่ายๆ",
        description: "รวมเคล็ดลับและขั้นตอนการทำความสะอาดโซฟาผ้าด้วยของใช้ในบ้าน เพื่อจัดการคราบเล็กๆ น้อยๆ ก่อนเรียกใช้บริการจากมืออาชีพ",
        category: "เคล็ดลับทำความสะอาด",
        content: `<p>โซฟาผ้าเป็นเฟอร์นิเจอร์ชิ้นโปรดของใครหลายคน แต่ก็เป็นแหล่งสะสมฝุ่นและเกิดคราบได้ง่าย การทำความสะอาดโซฟาผ้าด้วยตัวเองเป็นประจำจะช่วยยืดอายุการใช้งานและทำให้โซฟาของคุณดูเหมือนใหม่อยู่เสมอ วันนี้เรามีเคล็ดลับง่ายๆ มาฝากกันครับ</p><h2>1. เตรียมอุปกรณ์</h2><ul><li>เครื่องดูดฝุ่น (พร้อมหัวดูดแบบแปรง)</li><li>ผ้าไมโครไฟเบอร์สะอาด 2-3 ผืน</li><li>น้ำอุ่น</li><li>น้ำยาล้างจาน หรือ สบู่อ่อนๆ</li><li>เบกกิ้งโซดา (สำหรับกำจัดกลิ่น)</li></ul><h2>2. ดูดฝุ่นให้ทั่ว</h2><p>ขั้นตอนแรกที่สำคัญที่สุดคือการดูดฝุ่น ใช้เครื่องดูดฝุ่นพร้อมหัวแปรงดูดเศษผง ฝุ่น และขนสัตว์เลี้ยงออกจากโซฟาให้หมดจดทุกซอกทุกมุม รวมถึงใต้เบาะรองนั่งและหมอนอิง การดูดฝุ่นจะช่วยป้องกันไม่ให้ฝุ่นกลายเป็นคราบโคลนเมื่อโดนน้ำ</p><h2>3. จัดการคราบเฉพาะจุด</h2><p>ผสมน้ำยาล้างจานเล็กน้อยกับน้ำอุ่น ใช้ผ้าไมโครไฟเบอร์ชุบน้ำยาที่ผสมไว้แล้วบิดให้หมาดที่สุด จากนั้นค่อยๆ ซับลงบนคราบเบาๆ <strong>ห้ามถูแรงๆ</strong> เพราะจะทำให้คราบกระจายตัวและซึมลึกลงไปในเนื้อผ้า ให้ซับจากขอบนอกของคราบเข้ามาด้านใน เมื่อคราบจางลงแล้ว ให้ใช้ผ้าสะอาดอีกผืนชุบน้ำเปล่าบิดหมาดซับเพื่อล้างน้ำยาออก</p><h3>เมื่อไหร่ที่ควรเรียกมืออาชีพ?</h3><p>หากคราบฝังแน่นเกินไป หรือคุณไม่มั่นใจ การ <a href="/th/#services">เรียกใช้บริการซักโซฟาจากมืออาชีพ</a> ก็เป็นทางเลือกที่ดีที่สุดเพื่อถนอมโซฟาของคุณครับ</p>`,
        metaTitle: "วิธีซักโซฟาผ้าด้วยตัวเอง | กำจัดคราบง่ายๆ ใน 3 ขั้นตอน",
        metaDescription: "เรียนรู้วิธีซักโซฟาผ้าด้วยตัวเองง่ายๆ ด้วยอุปกรณ์ในบ้าน กำจัดคราบสกปรกและคืนความใหม่ให้โซฟาของคุณ อ่านเคล็ดลับทั้งหมดที่นี่"
    },
    {
        slug: "5-สัญญาณเตือนถึงเวลาซักเบาะรถยนต์",
        image: "https://placehold.co/800x400.png",
        imageHint: "car seat interior",
        date: "2024-07-18",
        title: "5 สัญญาณเตือน! ถึงเวลาต้องซักเบาะรถยนต์แล้ว",
        description: "เบาะรถยนต์ของคุณมีกลิ่นอับ มีคราบแปลกๆ หรือไม่? มาเช็คสัญญาณที่บ่งบอกว่าเบาะรถของคุณต้องการการทำความสะอาดครั้งใหญ่",
        category: "บริการของเรา",
        content: `<p>เบาะรถยนต์เป็นส่วนที่เราสัมผัสอยู่ตลอดเวลา จึงไม่น่าแปลกใจที่จะกลายเป็นแหล่งสะสมของเชื้อโรค ฝุ่น และคราบสกปรกต่างๆ แต่หลายคนอาจไม่แน่ใจว่าเมื่อไหร่ถึงควรทำความสะอาดครั้งใหญ่ ลองมาเช็ค 5 สัญญาณเตือนนี้กันดูครับ</p><h2>1. มีกลิ่นไม่พึงประสงค์</h2><p>หากเปิดประตูรถเข้ามาแล้วได้กลิ่นอับ กลิ่นอาหาร หรือกลิ่นเหม็นเปรี้ยว นั่นคือสัญญาณชัดเจนว่ามีแบคทีเรียและเชื้อราเติบโตอยู่ในเบาะรถของคุณแล้ว การใช้สเปรย์ปรับอากาศเป็นเพียงการแก้ปัญหาที่ปลายเหตุเท่านั้น</p><h2>2. เห็นคราบสกปรกชัดเจน</h2><p>คราบกาแฟ, น้ำอัดลม, ขนม หรือรอยเปื้อนจากเหงื่อไคลที่เห็นได้ด้วยตาเปล่า ไม่เพียงแต่ทำให้รถดูไม่สวยงาม แต่ยังเป็นแหล่งอาหารชั้นดีของเชื้อโรคอีกด้วย หากปล่อยไว้นาน คราบเหล่านี้จะยิ่งฝังลึกและทำความสะอาดยากขึ้น</p><h2>3. สีของเบาะหมองคล้ำลง</h2><p>เบาะรถยนต์ที่เคยมีสีสันสดใสอาจดูหมองลงเพราะฝุ่นและคราบสกปรกที่สะสมอยู่ตามร่องผ้าหรือหนัง การทำความสะอาดจะช่วยคืนสีเดิมให้กลับมาสดใสได้</p><p>หากคุณพบสัญญาณเหล่านี้ อย่ารอช้า! ติดต่อใช้ <a href="/th/#services">บริการซักเบาะรถยนต์</a> จากเราเพื่อคืนความสะอาดและสุขอนามัยที่ดีให้กับรถของคุณ</p>`,
        metaTitle: "5 สัญญาณเตือนควรซักเบาะรถยนต์ | SofaClean Pro",
        metaDescription: "รถมีกลิ่นอับ? เบาะมีคราบสกปรก? เช็ค 5 สัญญาณเตือนที่บอกว่าถึงเวลาซักเบาะรถยนต์แล้ว เพื่อสุขอนามัยที่ดีและรถที่น่าใช้งานยิ่งขึ้น"
    },
    {
        slug: "ซักโซฟา-กับ-ซักพรม-ต่างกันอย่างไร",
        image: "https://placehold.co/800x400.png",
        imageHint: "sofa carpet",
        date: "2024-07-15",
        title: "ซักโซฟา กับ ซักพรม เหมือนหรือต่างกันอย่างไร?",
        description: "หลายคนอาจคิดว่าการซักโซฟาและพรมใช้วิธีเดียวกัน บทความนี้จะมาไขข้อข้องใจถึงความแตกต่างของวัสดุและวิธีการทำความสะอาด",
        category: "เกร็ดความรู้",
        content: `<p>หลายท่านอาจคิดว่าการ <a href="/th/#services">ซักโซฟา</a> และซักพรมนั้นใช้วิธีการเดียวกันได้ เพราะต่างก็เป็นเฟอร์นิเจอร์ที่ทำจากผ้าเหมือนกัน แต่ในความเป็นจริงแล้ว ทั้งสองอย่างนี้มีความแตกต่างกันในรายละเอียดที่สำคัญ ซึ่งส่งผลต่อวิธีการทำความสะอาดที่เหมาะสม</p><h2>ความแตกต่างหลัก</h2><ol><li><strong>โครงสร้างและวัสดุภายใน:</strong> โซฟามีโครงสร้างที่ซับซ้อนกว่ามาก มีทั้งโครงไม้, ฟองน้ำ, สปริง และวัสดุบุภายในอื่นๆ ในขณะที่พรมมีเพียงชั้นของเส้นใยและแผ่นรองด้านหลัง การใช้น้ำมากเกินไปในการซักโซฟาอาจทำให้วัสดุภายในเสียหาย เกิดเชื้อรา และมีกลิ่นอับได้</li><li><strong>ชนิดของเส้นใย:</strong> ผ้าบุโซฟามีความหลากหลายสูงมาก ตั้งแต่ผ้าฝ้าย, ลินิน, กำมะหยี่ ไปจนถึงผ้าสังเคราะห์ ซึ่งแต่ละชนิดตอบสนองต่อน้ำยาและวิธีการทำความสะอาดแตกต่างกัน ในขณะที่พรมส่วนใหญ่มักทำจากเส้นใยสังเคราะห์ที่ทนทานกว่า</li></ol><p>ดังนั้น การเลือกใช้บริการจากผู้เชี่ยวชาญที่มีความเข้าใจในวัสดุแต่ละชนิดจึงเป็นสิ่งสำคัญ อ่านเพิ่มเติมเกี่ยวกับ <a href="/th/blog/วิธีซักโซฟาผ้าด้วยตัวเองเบื้องต้น">วิธีซักโซฟาผ้าด้วยตัวเองเบื้องต้น</a> เพื่อดูแลโซฟาของคุณได้เลย</p>`,
        metaTitle: "ความแตกต่างระหว่างการซักโซฟาและซักพรมที่ควรรู้",
        metaDescription: "ไขข้อข้องใจ ทำไมการซักโซฟาจึงไม่เหมือนกับการซักพรม? ทำความเข้าใจความแตกต่างของวัสดุและเทคนิคการทำความสะอาดที่ถูกต้อง"
    },
];

export default function MigratePage() {
    const [loading, setLoading] = useState(false);
    const [migrated, setMigrated] = useState(false);
    const [alreadyExists, setAlreadyExists] = useState(false);
    const { toast } = useToast();

    const handleMigration = async () => {
        setLoading(true);
        setAlreadyExists(false);

        try {
            const postsCollection = collection(db, 'posts');
            const snapshot = await getDocs(postsCollection);
            
            if (!snapshot.empty) {
                 toast({
                    variant: "destructive",
                    title: "ข้อมูลมีอยู่แล้ว",
                    description: "มีบทความในฐานข้อมูลแล้ว ไม่จำเป็นต้องย้ายข้อมูลซ้ำ",
                });
                setAlreadyExists(true);
                setLoading(false);
                return;
            }

            for (const post of oldBlogData) {
                await addDoc(postsCollection, post);
            }
            
            toast({
                title: "ย้ายข้อมูลสำเร็จ!",
                description: `นำเข้าบทความเก่า ${oldBlogData.length} ชิ้นเรียบร้อยแล้ว`,
            });
            setMigrated(true);

        } catch (error) {
            console.error("Error migrating posts: ", error);
            toast({
                variant: "destructive",
                title: "เกิดข้อผิดพลาด",
                description: "ไม่สามารถย้ายข้อมูลบทความได้",
            });
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="min-h-screen bg-gray-50 p-8">
            <div className="max-w-2xl mx-auto">
                <Card>
                    <CardHeader>
                        <div className="flex justify-center mb-4">
                            <HardDriveUpload className="w-12 h-12 text-primary" />
                        </div>
                        <CardTitle className="text-center">ย้ายข้อมูลบทความเก่าเข้าระบบ</CardTitle>
                        <CardDescription className="text-center">
                            คลิกปุ่มด้านล่างเพื่อนำเข้าบทความเก่า 3 บทความจากโค้ดมายังระบบจัดการใหม่ (Firestore)
                            <br />
                            <strong>ขั้นตอนนี้ทำเพียงครั้งเดียวเท่านั้น</strong>
                        </CardDescription>
                    </CardHeader>
                    <CardContent className="text-center">
                        {migrated ? (
                             <div className="p-4 bg-green-100 text-green-800 rounded-md flex items-center justify-center">
                                <CheckCircle className="mr-2" />
                                <span>ย้ายข้อมูลสำเร็จ! ตอนนี้คุณสามารถไปจัดการบทความต่อได้เลย</span>
                            </div>
                        ) : alreadyExists ? (
                            <div className="p-4 bg-yellow-100 text-yellow-800 rounded-md flex items-center justify-center">
                                <AlertTriangle className="mr-2" />
                                <span>มีข้อมูลอยู่แล้ว ไม่จำเป็นต้องทำขั้นตอนนี้</span>
                            </div>
                        ) : (
                             <Button onClick={handleMigration} disabled={loading} size="lg">
                                {loading ? 'กำลังย้ายข้อมูล...' : 'เริ่มย้ายข้อมูลทันที'}
                            </Button>
                        )}

                         <div className="mt-8">
                            <Button variant="outline" asChild>
                                <Link href="/admin/dashboard">กลับไปหน้า Dashboard</Link>
                            </Button>
                        </div>
                       
                    </CardContent>
                </Card>
            </div>
        </div>
    );
}
